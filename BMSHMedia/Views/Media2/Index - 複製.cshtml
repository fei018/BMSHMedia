@model MediaScanVM
@{
    var topPath = MediaBaseVM.EncodePath(SiteConfigInfo.MediaRootPath);
}

@section ScriptTop {
    <script>
        function scanSubFolder(path) {
            let url = "/media/list"

            $.post(url, { path: path }, function (data) {
                $('#mediaFileList').html(data);
                
            }, 'html');
        }

        function addLisenter_dbclick_media(selector) {
            var touchtime = 0;
            $(selector).on("click", function () {
                if (touchtime == 0) {
                    // set first click
                    touchtime = new Date().getTime();
                } else {
                    // compare first click to this click and see if they occurred within double click threshold
                    if (((new Date().getTime()) - touchtime) < 800) {
                        // double click occurred

                        scanSubFolder($(this).attr('data-path'));

                        touchtime = 0;
                    } else {
                        // not a double click so set as a new first click
                        touchtime = new Date().getTime();
                    }
                }
            });
        }

        // 彈出窗口
        // function mediaPlay(obj) {
        //     let url = $(obj).attr('data-path');
        //     let title = $(obj).attr('data-title');
        //     let filetype = $(obj).attr('data-fileType');

        //     $.post('/media/play', { url: url, fileType: filetype }, function (html) {
        //         layui.layer.open({
        //             type: 1,
        //             content: html,
        //             title: title,
        //             resize: false,
        //                     yes: function (index, layero) {
        //                 layui.layer.close(index);
        //             }
        //         });
        //     })
           
        // }
    </script>

}


<div class="container-m-nx container-m-ny bg-lightest mb-3">
    <ol class="breadcrumb text-big container-p-x py-3 m-0">
        <li class="breadcrumb-item">
            <a href="/media/index" style="font-size:1.2rem;text-decoration:underline">主目錄</a>
        </li>
        @*  <li class="breadcrumb-item">
        <a href="javascript:void(0)">projects</a>
        </li>
        <li class="breadcrumb-item active">site</li> *@
    </ol>
    @* <hr class="m-0" />
    <div class="file-manager-actions container-p-x py-2">
    <div>
    <button type="button" class="btn btn-primary mr-2"><i class="ion ion-md-cloud-upload"></i>&nbsp; Upload</button>
    <button type="button" class="btn btn-secondary icon-btn mr-2" disabled><i class="ion ion-md-cloud-download"></i></button>
    <div class="btn-group mr-2">
    <button type="button" class="btn btn-default md-btn-flat dropdown-toggle px-2" data-toggle="dropdown"><i class="ion ion-ios-settings"></i></button>
    <div class="dropdown-menu">
    <a class="dropdown-item" href="javascript:void(0)">Move</a>
    <a class="dropdown-item" href="javascript:void(0)">Copy</a>
    <a class="dropdown-item" href="javascript:void(0)">Remove</a>
    </div>
    </div>
    </div>
    <div>
    <div class="btn-group btn-group-toggle" data-toggle="buttons">
    <label class="btn btn-default icon-btn md-btn-flat active"> <input type="radio" name="file-manager-view" value="file-manager-col-view" checked /> <span class="ion ion-md-apps"></span> </label>
    <label class="btn btn-default icon-btn md-btn-flat"> <input type="radio" name="file-manager-view" value="file-manager-row-view" /> <span class="ion ion-md-menu"></span> </label>
    </div>
    </div>
    </div> *@
    <hr class="m-0" />
</div>

<div id="mediaFileList">
</div>


<script>
    scanSubFolder('@topPath');  
</script>
